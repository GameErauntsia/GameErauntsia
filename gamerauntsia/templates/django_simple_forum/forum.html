
{% extends "base.html" %}
{% load pagination_tags %}

{% block title %}Foroa - {% endblock %}

{% block content %}
<!-- Threads  -->
<h1 class="page-header">Foroa <small>{{forum.title}}</small></h1>
<p class="breadcrumb"><a href="/foroa">Denak</a>-><strong>{{forum.title}}</strong></p>
<p>{{forum.description}}</p>

{% if request.user.is_authenticated %}
<div class="row">
    <div class="col-lg-12">
        <a id="new_topic" class="btn btn-primary" href="{% url 'new-topic' forum.slug %}">Gai berria hasi</a>
    </div>
</div>
{% endif %}

<div class="row">
    <div class="col-lg-12">
        <div id="list">
            <div class="table-responsive">
                {% autopaginate topics 20 %}
                <table class="table table-condensed table-hover">
                    <thead>
                        <tr>
                            <th>Gaiak</th>
                            <th class="hide">Mezuak</th>
                            <th>Azken mezua</th>
                            <th class="hide">Egilea</th>
                            <th class="hide">Noiz sortua</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for topic in topics %}
                        <tr {% if topic.block_top %}class="active"{% else %}{% if topic.last_post.updated > user.last_login %}class="bg-success"{% endif %}{% endif %}>
                            <td>
                                <div class="title"> <a href="{% url 'topic-detail' forum.slug topic.pk %}"><span class="{% if topic.block_top%}glyphicon glyphicon-envelope{% else %}{%if topic.closed %}glyphicon glyphicon-folder-close{% else %}glyphicon glyphicon-folder-open{% endif %}{% endif %}"></span> {{ topic.title }}</a>
                                </div>
                            </td>
                            <td class="hide">{{topic.num_posts}}</td>
                            <td>
                                {% if topic.last_post %}
                                <div class="col-lg-2">
                                    <img src="{{topic.last_post.creator.get_photo.get_profilesmall_url}}" class="img-circle"/>
                                </div>
                                <div class="col-lg-10">
                                <a href="/foroa/{{forum.slug}}{{topic.last_post.get_absolute_url}}">{{topic.last_post.short|linebreaksbr}}</a>
                                </div>
                                {% endif %}
                            </td>
                            <td class="hide">{{topic.creator}}</td>
                            <td class="hide">{{topic.created}}</td>
                            <td>
                                {% if topic.last_post.updated > user.last_login %}
                                    <strong class="text-success"><span aria-hidden="true" class="glyphicon glyphicon-star-empty"></span> BERRIA</strong>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% paginate %}
            </div>
        </div>
    </div>
</div>

<!-- Next/Prev page links  -->
{% if topics.object_list and topics.paginator.num_pages > 1 %}
<div class="pagination">
    <span class="step-links">
        {% if topics.has_previous %}
            <a href= "?page={{ topics.previous_page_number }}">previous &lt;&lt; </a>
        {% endif %}

        <span class="current">
            &nbsp;Page {{ topics.number }} of {{ topics.paginator.num_pages }}
        </span>

        {% if topics.has_next %}
            <a href="?page={{ topics.next_page_number }}"> &gt;&gt; next</a>
        {% endif %}
    </span>
</div>
{% endif %}

{% endblock %}
